<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Карточки для запоминания</title>
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        />
        <link rel="stylesheet"
          href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    </head>
    <body>
        <div class="container mt-3">
            <div class="row">
                <div class="col-md-6">
                    <h2>Добавить карточку</h2>
                    <form>
                        <div class="form-group">
                            <label for="card-title">Название:</label>
                            <input
                                type="text"
                                class="form-control"
                                id="card-title"
                                placeholder="Введите название"
                            />
                        </div>
                        <div class="form-group">
                            <label for="card-question">Вопрос:</label>
                            <input
                                type="text"
                                class="form-control"
                                id="card-question"
                                placeholder="Введите вопрос"
                            />
                        </div>
                        <div class="form-group">
                            <label for="card-answer">Ответ:</label>
                            <textarea
                                class="form-control"
                                id="card-answer"
                                rows="3"
                                placeholder="Введите ответ"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            Добавить карточку
                        </button>
                    </form>
                </div>
                <div class="col-md-6">
                    <h2>Карточки</h2>
                    <div id="card-list"></div>
                </div>
            </div>
        </div>

        <script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>

<script>    
    // function addCardToList(cardTitle, cardQuestion, cardAnswer) {
    // const cardTemplate = `
    //     <div class="card mb-3">
    //         <div class="card-body">
    //             <h5 class="card-title">${cardTitle}</h5>
    //             <p class="card-text">${cardQuestion}</p>
    //             <p class="card-text d-none">${cardAnswer}</p>
    //             <button type="button" class="btn btn-danger btn-sm float-right delete-card">Удалить</button>
    //         </div>
    //     </div>
    // `;    

    // function addCardToList(cardTitle, cardQuestion, cardAnswer) {
    // const cardTemplate = `
    //     <div class="card mb-3">
    //         <div class="card-body">
    //             <h5 class="card-title">${cardTitle}</h5>
    //             <p class="card-text">${cardQuestion}</p>
    //             <pre><code class="card-text language-js d-none">${cardAnswer}</code></pre>
    //             <button type="button" class="btn btn-danger btn-sm float-right delete-card">Удалить</button>
    //         </div>
    //     </div>
    // `;
    
    // const cardList = document.getElementById('card-list');
    // cardList.insertAdjacentHTML('beforeend', cardTemplate);


      
    // // add click handler to the card
    // const cards = cardList.querySelectorAll('.card');
    // const lastCard = cards[cards.length - 1];
    // lastCard.addEventListener('click', function (event) {
//     function addCardToList(cardTitle, cardQuestion, cardAnswer) {
//     let cardAnswerElement = '';
//     if (cardAnswer.startsWith('<') && cardAnswer.endsWith('>')) {  // Check if answer is a code snippet
//         cardAnswerElement = `<pre><code class="card-text language-js d-none">${cardAnswer}</code></pre>`;
//     } else {
//         cardAnswerElement = `<p class="card-text d-none">${cardAnswer}</p>`;
//     }

//     const cardTemplate = `
//         <div class="card mb-3">
//             <div class="card-body">
//                 <h5 class="card-title">${cardTitle}</h5>
//                 <p class="card-text">${cardQuestion}</p>
//                 ${cardAnswerElement}
//                 <button type="button" class="btn btn-danger btn-sm float-right delete-card">Удалить</button>
//             </div>
//         </div>
//     `;

//     const cardList = document.getElementById('card-list');
//     cardList.insertAdjacentHTML('beforeend', cardTemplate);

//     const cards = cardList.querySelectorAll('.card');
//     const lastCard = cards[cards.length - 1];

//     lastCard.addEventListener('click', function (event) {
//         const targetElement = event.target;
//         if (targetElement.classList.contains('delete-card')) {
//             const cardTitleElement = lastCard.querySelector('.card-title');
//             const cardTitle = cardTitleElement.textContent.trim();
//             let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
//             cardsData = cardsData.filter((cardData) => cardData.title != cardTitle);
//             localStorage.setItem('cards', JSON.stringify(cardsData));
//             lastCard.remove();
//         } else {
//             const cardTexts = lastCard.querySelectorAll('.card-text');
//             cardTexts[0].classList.toggle('d-none');
//             cardTexts[1].classList.toggle('d-none');
//         }
//     });
    
//     // подсветка блока кода
//     const codeBlocks = lastCard.querySelectorAll('code');
//     for (const codeBlock of codeBlocks) {
//         hljs.highlightBlock(codeBlock);
//     }
        
//     // Clear the form except for the card title
//     const cardQuestionInput = document.getElementById('card-question');
//     cardQuestionInput.value = '';
//     const cardAnswerInput = document.getElementById('card-answer');
//     cardAnswerInput.value = '';
//     // Store card data in localStorage
//     let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
//     cardsData = cardsData.filter((cardData) => cardData.title != cardTitle);
//     cardsData.push({ title: cardTitle, question: cardQuestion, answer: cardAnswer });
//     localStorage.setItem('cards', JSON.stringify(cardsData));
// }

// // form submission handler
// const form = document.querySelector('form');
// form.addEventListener('submit', function (event) {
//     event.preventDefault();
//     const cardTitleInput = document.getElementById('card-title');
//     const cardQuestionInput = document.getElementById('card-question');
//     const cardAnswerInput = document.getElementById('card-answer');
//     const cardTitle = cardTitleInput.value.trim();
//     const cardQuestion = cardQuestionInput.value.trim();
//     const cardAnswer = cardAnswerInput.value.trim();
//     if (cardTitle && cardQuestion && cardAnswer) {
//         addCardToList(cardTitle, cardQuestion, cardAnswer);
//     }
// })

// window.addEventListener('load', function () {
//     let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
//     cardsData.forEach(function (cardData) {
//         addCardToList(cardData.title, cardData.question, cardData.answer);
//     })
// })
    function addCardToList(cardTitle, cardQuestion, cardAnswer) {
    let cardAnswerElement = '';
    cardAnswerElement = `<pre><code class="card-text language-js d-none">${cardAnswer}</code></pre>`;
    // cardAnswerElement = `<p class="card-text d-none">${cardAnswer}</p>`;
    const cardTemplate = `
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">${cardTitle}</h5>
                <p class="card-text">${cardQuestion}</p>
                ${cardAnswerElement}
                <button type="button" class="btn btn-danger btn-sm float-right delete-card">Удалить</button>
            </div>
        </div>
    `;

    const cardList = document.getElementById('card-list');
    cardList.insertAdjacentHTML('beforeend', cardTemplate);

    const cards = cardList.querySelectorAll('.card');
    const lastCard = cards[cards.length - 1];

    lastCard.addEventListener('click', function (event) {
        const targetElement = event.target;
        if (targetElement.classList.contains('delete-card')) {
            const cardTitleElement = lastCard.querySelector('.card-title');
            const cardTitle = cardTitleElement.textContent.trim();
            let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
            cardsData = cardsData.filter((cardData) => cardData.title != cardTitle);
            localStorage.setItem('cards', JSON.stringify(cardsData));
            lastCard.remove();
        } else {
            const cardTexts = lastCard.querySelectorAll('.card-text');
            cardTexts[0].classList.toggle('d-none');
            cardTexts[1].classList.toggle('d-none');
        }
    });

    const codeBlocks = lastCard.querySelectorAll('code');
    for (const codeBlock of codeBlocks) {
        hljs.highlightBlock(codeBlock);
    }

    const cardQuestionInput = document.getElementById('card-question');
    cardQuestionInput.value = '';
    const cardAnswerInput = document.getElementById('card-answer');
    cardAnswerInput.value = '';

    let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
    cardsData = cardsData.filter((cardData) => cardData.title != cardTitle);
    cardsData.push({ title: cardTitle, question: cardQuestion, answer: cardAnswer });
    localStorage.setItem('cards', JSON.stringify(cardsData));
}

const form = document.querySelector('form');
form.addEventListener('submit', function (event) {
    event.preventDefault();
    const cardTitleInput = document.getElementById('card-title');
    const cardQuestionInput = document.getElementById('card-question');
    const cardAnswerInput = document.getElementById('card-answer');
    const cardTitle = cardTitleInput.value.trim();
    const cardQuestion = cardQuestionInput.value.trim();
    const cardAnswer = cardAnswerInput.value.trim();
    if (cardTitle && cardQuestion && cardAnswer) {
        addCardToList(cardTitle, cardQuestion, cardAnswer);
    }
})

window.addEventListener('load', function () {
    let cardsData = JSON.parse(localStorage.getItem('cards')) || [];
    cardsData.forEach(function (cardData) {
        addCardToList(cardData.title, cardData.question, cardData.answer);
    })
})

        </script>
    </body>
</html>
